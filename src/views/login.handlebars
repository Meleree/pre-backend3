<h1>{{title}}</h1>

{{#if welcomeMessage}}
    <div class="alert alert-success text-center">{{welcomeMessage}}</div>
{{/if}}

{{#if error}}
    <div class="alert alert-danger text-center">Credenciales inv치lidas. Intent치 nuevamente.</div>
{{/if}}

<form id="loginForm" class="login-form">
    <div>
        <label>Email:</label>
        <input type="email" id="email" required />
    </div>

    <div>
        <label>Contrase침a:</label>
        <input type="password" id="password" required />
    </div>

    <button type="submit" class="btn btn-primary">Ingresar</button>
</form>

<p>쯅o ten칠s cuenta? <a href="/register">Registrate ac치</a></p>

<script>
document.getElementById("loginForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    try {
        const response = await fetch("/api/auth/login", { 
            method: "POST",
            headers: { 
                "Content-Type": "application/json",
                "Accept": "application/json"
            },
            body: JSON.stringify({ email, password }),
            credentials: "include"
        });

        const data = await response.json();

        if (response.ok && data.success) {
            alert("Inicio de sesi칩n exitoso 游땏");
            window.location.href = "/";
        } else {
            alert(data.message || "Credenciales inv치lidas.");
        }
    } catch (error) {
        console.error("Error al iniciar sesi칩n:", error);
        alert("Hubo un problema con el inicio de sesi칩n.");
    
});
</script>